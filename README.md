# ZONT's Metrostroi Scripts

[Steam Workshop](https://steamcommunity.com/sharedfiles/filedetails/?id=3590604630)

Коллекция скриптов и инструментов для Метростроя.

Не совместимо с singleplayer-ом, не проверено на listenserver-е (хост из меню игры). Предназначено только для выделенного сервера (dedicated server).

Все аддоны, указанные в зависимостях в [Steam Workshop](https://steamcommunity.com/sharedfiles/filedetails/?id=3590604630) - требуются для нормальной работы этого аддона.
Аддон также совместим с [Метростроем из GitHub](https://github.com/metrostroi-repo/MetrostroiAddon) и [Metrostroi Extensions Library (MEL)](https://steamcommunity.com/sharedfiles/filedetails/?id=3401843254). Более того, он создан с расчетом на эти совместимости, однако совместимость и с Метростроем из воркшопа тоже поддерживается, но недостаточно протестирована.
При обнаружении ошибок/багов, появившихся с этим аддоном - пишите в соответсвующую тему обсуждений под аддоном. Вместе с баг-репортом, обязательно указывайте, установлен ли у вас MEL и Метрострой с гитхаба. Репорты в комментариях, либо неполноценные репорты (без необходимой информации), будут проигнорированы.

## Фичи аддона

В игре всё можно найти, открыв список команд ULX и изучив раздел "ZONT_ Metrostroi".

### HUD
Выключено здоровье игрока. Добвалено кол-во пассажиров и расстояние до следующей станции, если игрок сидит в поезде. Опционально. Можно выключить в Q-меню.

### Отметки на панелях
На P/5КМ можно отметить любой интерактивный элемент в поезде. Эту отметку увидят все ближайшие игроки. Поменять клавишу пока невозможно, возможность будет добавлена в будущем.

### Утилиты диспетчера
Для полного функционала, требуется [MetrostroiDispatcher](https://steamcommunity.com/sharedfiles/filedetails/?id=1673775394).
**Маршруты**. Позволяет администратору сервера добавлять часто используемые маршруты для команды sopen в c-меню.
**Мониторинг АСНП**. Позволяет админам и диспетчеру видеть на HUD-е настройку всех комплектов АСНП на сервере. Можно выключить в C-меню.
**Приоритетное сообщение**. Диспетчер и администраторы может вывести сообщение для всех игроков. Оно будет отображаться сверху на HUD и продублировано в чат. Функция доступна в C-меню.

### Иммерсивное радио
Данный режим может включить диспетчер и администроторы. В этом режиме, будет работать proximity-чат. На расстоянии друг друга смогут услышать только диспетчер (либо администратор, включивший режим) и игрок, который находится в / рядом с кабиной поезда, где включена радиостанция.
Любой игрок может его включить для себя локально - командой в чат "!local_immersive".

### Скрипты для АТЗ
Содержит такие скрипты, как срыв автостопа (в головном/хвостовом вагоне), эмуляция пожара через АСОТП (требуется MEL), выбивание автомата без возможности восстановления, выбивание автомата X от питание на реле Y, или на поездном проводе Z, задержка контроля дверей, требование переигровки дверьми и т.д.

### Прошивка АСНП (только MEL)
Является рецептом для [MEL](https://steamcommunity.com/sharedfiles/filedetails/?id=3401843254) и без него работать не будет.
В спавнер добвалена опция изменения прошивки АСНП: Старая (воркшопный Метрострой), Новая (Метрострой с гитхаба, плюс мои фиксы и улучшения), и без изменений (АСНП модифицироваться не бдует).
В новой прошивке изменен процесс настройки, а также добавлена возможность пропускать сообщения повторным нажатием кнопки/тумблера "Программа 1".

### Категоризированное спавнменю (только MEL)
Использована фича из обновления MEL с возможностью разбивать новые настройки в спавнере по категориям, и все ванильные настройки, а также настройки из некоторых аддонов мастерской, теперь все разбиты по этим категориям.

### Остальное
- Удочка под напряжением убивает, если ее взять в руки
- Есть заготовка под систему гайдов, однако разработка заморожена
- Есть API для удобного получения информации об игроках и поездах на сервере, WIP

# Metrostroi Gamemode

[Steam Workshop](https://steamcommunity.com/sharedfiles/filedetails/?id=3590738674)

Игровой режим для метростроя. Стремимся к тому, что бы игра стала более похожей на симулятор, чем на Garry's Mod.

## TODO

- [x] Finish refactoring
- [ ] Main menu *<-- current*
  - [ ] MOTD replacement *<-- current*
  - [ ] Players info
  - [ ] Teleports
  - [ ] Spawn trains on map
    - [ ] Spawn system
      - [ ] Blocking conditions
    - [ ] Spawnmenu
      - [ ] Re-implementation
      - [ ] Presets
      - [ ] Restrictions
        - [ ] Refine ZMS restrictions
        - [ ] Spawn points restrictions
  - [ ] Spectator mode
    - [ ] Disable noclip option
- [ ] Automatic driver rank assigning/revoking
  - [ ] Penalty system
  - [ ] Test for assignment
    - [ ] Also for exam clearance
- [ ] Interactive guides
- [ ] Player driving statistics, performance points
- [ ] Scenario system
